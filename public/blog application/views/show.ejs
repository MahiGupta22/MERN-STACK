<%- include("partials/header") %>

<article class="post mb-4">
  <h2><%= post.title %></h2>
  <p class="text-muted">
    Category: <%= post.category || "Uncategorized" %> | 
    Tags: <% if (post.tags.length) { %>
            <%= post.tags.join(", ") %>
          <% } else { %>
            None
          <% } %>
  </p>
  <p><%= post.content %></p>
</article>

<a href="/posts/<%= post.id %>/edit" class="btn btn-sm btn-info">✏️ Edit</a>
<form action="/posts/<%= post.id %>?_method=DELETE" method="POST" style="display:inline;">
  <button type="submit" class="btn btn-sm btn-danger">🗑 Delete</button>
</form>

<hr>

<h3>Comments</h3>
<% if (post.comments.length === 0) { %>
  <p>No comments yet.</p>
<% } else { %>
  <ul class="list-group mb-3">
    <% post.comments.forEach(c => { %>
      <li class="list-group-item"><strong><%= c.name %>:</strong> <%= c.text %></li>
    <% }) %>
  </ul>
<% } %>

<form action="/posts/<%= post.id %>/comments" method="POST" class="form">
  <div class="mb-3">
    <label for="name" class="form-label">Your Name</label>
    <input type="text" name="name" class="form-control" required>
  </div>
  <div class="mb-3">
    <label for="text" class="form-label">Comment</label>
    <textarea name="text" class="form-control" rows="3" required></textarea>
  </div>
  <button type="submit" class="btn btn-secondary">Add Comment</button>
</form>

<%- include("partials/footer") %>